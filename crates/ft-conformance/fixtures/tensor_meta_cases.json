{
  "cases": [
    {
      "name": "contiguous_basic_index",
      "shape": [2, 3],
      "storage_offset": 0,
      "index": [1, 2],
      "expected_linear_index": 5,
      "expected_numel": 6,
      "expected_contiguous": false,
      "expect_valid": true,
      "alias_offset": 0,
      "contract_ids": ["CPU-KERNEL-004", "INV-BROADCAST-VALIDITY"],
      "e2e_scenarios": ["cpu_kernel:broadcast_shape_match"]
    },
    {
      "name": "strided_offset_index",
      "shape": [2, 2],
      "strides": [4, 1],
      "storage_offset": 3,
      "index": [1, 1],
      "expected_linear_index": 8,
      "expected_numel": 4,
      "expected_contiguous": true,
      "expect_valid": true,
      "alias_offset": 2,
      "contract_ids": ["CPU-KERNEL-004", "INV-BROADCAST-VALIDITY"],
      "e2e_scenarios": ["cpu_kernel:broadcast_shape_match"]
    },
    {
      "name": "scalar_offset_index",
      "shape": [],
      "storage_offset": 7,
      "index": [],
      "expected_linear_index": 7,
      "expected_numel": 1,
      "expected_contiguous": true,
      "expect_valid": true,
      "alias_offset": 5,
      "contract_ids": ["CPU-KERNEL-004", "INV-BROADCAST-VALIDITY"],
      "e2e_scenarios": ["cpu_kernel:broadcast_shape_match"]
    },
    {
      "name": "broadcast_stride_zero_valid",
      "shape": [1, 3],
      "strides": [0, 1],
      "storage_offset": 0,
      "index": [0, 2],
      "expected_linear_index": 2,
      "expected_numel": 3,
      "expected_contiguous": true,
      "expect_valid": true,
      "alias_offset": 0,
      "contract_ids": ["CPU-KERNEL-004", "INV-BROADCAST-VALIDITY"],
      "e2e_scenarios": ["cpu_kernel:broadcast_shape_match"]
    },
    {
      "name": "invalid_rank_stride_mismatch",
      "shape": [2, 2],
      "strides": [2],
      "storage_offset": 0,
      "index": [0, 0],
      "expect_valid": false,
      "contract_ids": ["CPU-KERNEL-005", "INV-INPLACE-GUARD"],
      "e2e_scenarios": ["cpu_kernel:inplace_shape_guard"]
    },
    {
      "name": "invalid_storage_offset_overflow",
      "shape": [2],
      "strides": [18446744073709551615],
      "storage_offset": 1,
      "index": [0],
      "expect_valid": false,
      "contract_ids": ["CPU-KERNEL-005", "INV-INPLACE-GUARD"],
      "e2e_scenarios": ["cpu_kernel:inplace_shape_guard"]
    },
    {
      "name": "invalid_rank_stride_extra_fail_closed",
      "shape": [1, 1, 1],
      "strides": [1, 1],
      "storage_offset": 0,
      "index": [0, 0, 0],
      "expect_valid": false,
      "contract_ids": ["CPU-KERNEL-005", "INV-INPLACE-GUARD"],
      "e2e_scenarios": ["cpu_kernel:inplace_shape_guard"]
    },
    {
      "name": "invalid_storage_offset_overflow_large",
      "shape": [3],
      "strides": [18446744073709551615],
      "storage_offset": 2,
      "index": [0],
      "expect_valid": false,
      "contract_ids": ["CPU-KERNEL-005", "INV-INPLACE-GUARD"],
      "e2e_scenarios": ["cpu_kernel:inplace_shape_guard"]
    }
  ]
}
