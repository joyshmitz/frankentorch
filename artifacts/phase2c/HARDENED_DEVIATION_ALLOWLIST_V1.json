{
  "schema_version": "hardened-deviation-allowlist-v1",
  "policy": "allowlist-only",
  "strict_mode": {
    "unknown_incompatible_behavior": "fail_closed",
    "behavior_altering_repair": "forbidden"
  },
  "hardened_mode": {
    "require_allowlist_entry": true,
    "require_evidence_log": true,
    "bounded_recovery_only": true
  },
  "packets": {
    "FT-P2C-001": {
      "disallowed_by_default": true,
      "allowed_deviations": []
    },
    "FT-P2C-002": {
      "disallowed_by_default": true,
      "allowed_deviations": [
        {
          "id": "dispatch.composite_backend_fallback",
          "description": "Permit composite/backend-select dispatch keys to resolve to backend key in hardened mode only",
          "constraints": [
            "mode == hardened",
            "backend key is present",
            "fallback_used evidence recorded"
          ]
        }
      ]
    },
    "FT-P2C-003": {
      "disallowed_by_default": true,
      "allowed_deviations": []
    },
    "FT-P2C-004": {
      "disallowed_by_default": true,
      "allowed_deviations": [
        {
          "id": "autograd.reentrant_depth_bounded_fallback",
          "description": "Permit bounded reentrant depth clamp in hardened mode",
          "constraints": [
            "mode == hardened",
            "max depth configured",
            "reentrant_guard_triggered telemetry recorded"
          ]
        }
      ]
    },
    "FT-P2C-005": {
      "disallowed_by_default": true,
      "allowed_deviations": [
        {
          "id": "dispatch.composite_backend_fallback",
          "description": "Permit projected hardened dispatch composite/backend-select key fallback for FT-P2C-005 packet evidence",
          "constraints": [
            "mode == hardened",
            "backend key is present",
            "fallback_used evidence recorded",
            "scoped to projected dispatch-key checks in FT-P2C-005"
          ]
        }
      ]
    },
    "FT-P2C-006": {
      "disallowed_by_default": true,
      "allowed_deviations": [
        {
          "id": "serialization.bounded_malformed_diagnostic",
          "description": "Permit bounded diagnostic payload details for malformed input in hardened mode",
          "constraints": [
            "mode == hardened",
            "incompatible payload still rejected",
            "diagnostic output length bounded"
          ]
        }
      ]
    },
    "FT-P2C-007": {
      "disallowed_by_default": true,
      "allowed_deviations": [
        {
          "id": "dispatch.composite_backend_fallback",
          "description": "Permit bounded hardened dispatch composite/backend-select fallback for FT-P2C-007 device guard and backend transition scenarios",
          "constraints": [
            "mode == hardened",
            "backend key is present",
            "fallback_used evidence recorded",
            "scoped to packet FT-P2C-007 dispatch_key transition checks"
          ]
        }
      ]
    },
    "FT-P2C-008": {
      "disallowed_by_default": true,
      "allowed_deviations": [
        {
          "id": "nn_state.non_strict_missing_unexpected",
          "description": "Permit hardened mode to continue load_state_dict when only missing/unexpected keys are present and no incompatible shapes are detected",
          "constraints": [
            "mode == hardened",
            "incompatible_shapes is empty",
            "missing/unexpected key telemetry recorded deterministically"
          ]
        }
      ]
    }
  }
}
